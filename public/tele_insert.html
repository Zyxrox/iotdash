<html>

<head>
    <title>IoTDash</title>
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>

</head>

<body>
    <div class="mdl-layout mdl-js-layout">
        <main class="mdl-layout__content">
            <div class="page-content" style="padding-top: 60px;" align="center">
                <!-- Your content goes here -->
                <h4>Telemetry (Device Data) Dummy</h4>
                <form>
                    <table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
                        <tbody>
                            <tr>
                                <td class="mdl-data-table__cell--non-numeric">Device Key</td>
                                <td>
                                    <div class="mdl-textfield mdl-js-textfield">
                                        <input class="mdl-textfield__input" type="d_id" id="d_id">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="mdl-data-table__cell--non-numeric">Data Name #1</td>
                                <td>
                                    <div class="mdl-textfield mdl-js-textfield">
                                        <input class="mdl-textfield__input" type="channel1" id="channel1">
                                    </div>

                                </td>
                                <td class="mdl-data-table__cell--non-numeric">Value #1</td>
                                <td>
                                    <div class="mdl-textfield mdl-js-textfield">
                                        <input class="mdl-textfield__input" type="val1" id="val1">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="mdl-data-table__cell--non-numeric">Data Name #2</td>
                                <td>
                                    <div class="mdl-textfield mdl-js-textfield">
                                        <input class="mdl-textfield__input" type="channel2" id="channel2">
                                    </div>

                                </td>
                                <td class="mdl-data-table__cell--non-numeric">Value #2</td>
                                <td>
                                    <div class="mdl-textfield mdl-js-textfield">
                                        <input class="mdl-textfield__input" type="val2" id="val2">
                                    </div>

                                </td>
                            </tr>
                            <tr>
                                <td class="mdl-data-table__cell--non-numeric">
                                    <button id="add-data" class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent">
                                        Submit
                                    </button>
                                </td>
                                <td>

                                </td>
                            </tr>

                        </tbody>
                    </table>
                </form>
                <!--Insert JS-->
                <!-- Firebase App is always required and must be first -->
                <script src="https://www.gstatic.com/firebasejs/5.7.2/firebase-app.js"></script>

                <!-- Add additional services that you want to use -->
                <script src="https://www.gstatic.com/firebasejs/5.7.2/firebase-auth.js"></script>
                <script src="https://www.gstatic.com/firebasejs/5.7.2/firebase-database.js"></script>
                <!--Configure firebase-->
                <script>
                    function AddZero(num) {
                        return (num >= 0 && num < 10) ? "0" + num : num + "";
                    }
                    var config = {
                        "apiKey": "AIzaSyD-6IzYBipiBsBqmLCDizMG4w3zK273LBw",
                        "databaseURL": "https://iotdash.firebaseio.com",
                        "storageBucket": "iotdash.appspot.com",
                        "authDomain": "iotdash.firebaseapp.com",
                        "messagingSenderId": "595945601133",
                        "projectId": "iotdash"
                    };


                    firebase.initializeApp(config);
                    var database = firebase.database();

                    var fileButton = document.getElementById("fileButton");
                    document.getElementById("add-data").onclick = function (e) {

                        // var now = new Date();
                        // var strDateTime = [
                        //     [AddZero(now.getDate()),
                        //         AddZero(now.getMonth() + 1),
                        //         now.getFullYear()
                        //     ].join("/"),
                        //     [AddZero(now.getHours()),
                        //         AddZero(now.getMinutes())
                        //     ].join(":"),
                        //     now.getHours() >= 12 ? "PM" : "AM"
                        // ].join(" ");
                        // console.log(strDateTime);

                        var dayFormat = new Date();

                        var date =
                            dayFormat.getDate().toString() +
                            '-' +
                            (dayFormat.getMonth() + 1) +
                            '-' +
                            (dayFormat.getFullYear() + 543);

                        var time =
                            dayFormat.getHours().toString() +
                            ':' +
                            dayFormat.getMinutes().toString() +
                            ':' +
                            dayFormat.getMilliseconds().toString();

                        

                        var d_id = document.getElementById('d_id').value;
                        var channel1 = document.getElementById('channel1').value;
                        var val1 = document.getElementById('val1').value;
                        var channel2 = document.getElementById('channel2').value;
                        var val2 = document.getElementById('val2').value;

                        var rootRef = firebase.database().ref();
                        var storesRef = rootRef.child('tele/');
                        var newStoreRef = storesRef.push();

                        newStoreRef.set({
                            d_id: d_id,
                            channel1: channel1,
                            val1: val1,
                            channel2: channel2,
                            val2: val2,
                            time: date+" "+time
                        });
                        alert("Success");
                    }
                </script>
            </div>
        </main>
    </div>
</body>

</html>