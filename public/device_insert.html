<html>

<head>
    <title>IoTDash</title>
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
</head>

<body>
    <div class="mdl-layout mdl-js-layout">
        <main class="mdl-layout__content">
            <div class="page-content" style="padding-top: 60px;" align="center">
                <!-- Your content goes here -->
                <h4>Device Dummy</h4>
                <form>
                    <table class="mdl-data-table mdl-js-data-table mdl-shadow--2dp">
                        <tbody>
                            <tr>
                                <td class="mdl-data-table__cell--non-numeric">Device Name</td>
                                <td>
                                    <div class="mdl-textfield mdl-js-textfield">
                                        <input class="mdl-textfield__input" type="d_name" id="d_name">
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="mdl-data-table__cell--non-numeric">Owner (user_key)</td>
                                <td>
                                    <div class="mdl-textfield mdl-js-textfield">
                                        <input class="mdl-textfield__input" type="uid" id="uid">
                                    </div>

                                </td>
                            </tr>
                            <tr>
                                <td class="mdl-data-table__cell--non-numeric">
                                    <button id="add-data" class="mdl-button mdl-js-button mdl-button--raised mdl-button--accent">
                                        Submit
                                    </button>
                                </td>
                                <td>

                                </td>
                            </tr>

                        </tbody>
                    </table>
                </form>
                <!--Insert JS-->
                <!-- Firebase App is always required and must be first -->
                <script src="https://www.gstatic.com/firebasejs/5.7.2/firebase-app.js"></script>

                <!-- Add additional services that you want to use -->
                <script src="https://www.gstatic.com/firebasejs/5.7.2/firebase-auth.js"></script>
                <script src="https://www.gstatic.com/firebasejs/5.7.2/firebase-database.js"></script>
                <!--Configure firebase-->
                <script>
                    var config = {
                        "apiKey": "AIzaSyD-6IzYBipiBsBqmLCDizMG4w3zK273LBw",
                        "databaseURL": "https://iotdash.firebaseio.com",
                        "storageBucket": "iotdash.appspot.com",
                        "authDomain": "iotdash.firebaseapp.com",
                        "messagingSenderId": "595945601133",
                        "projectId": "iotdash"
                    };


                    firebase.initializeApp(config);
                    var database = firebase.database();

                    var fileButton = document.getElementById("fileButton");
                    document.getElementById("add-data").onclick = function (e) {

                        var d_name = document.getElementById('d_name').value;
                        var uid = document.getElementById('uid').value;
                        var rootRef = firebase.database().ref();
                        var storesRef = rootRef.child('device/');
                        var newStoreRef = storesRef.push();

                        let r = ((Math.random()*1000)+100000).toString(30);
                        newStoreRef.set({
                            d_name: d_name,
                            uid: uid,
                            d_token: r
                        });
                        alert("Success");
                    }
                </script>
            </div>
        </main>
    </div>
</body>

</html>